<!-- Handlebars is a superset of the Mustache template engine. A template engine helps you separate your HTML from dynamic content created by languages such as JavaScript. -->

<!DOCTYPE html>
<html>
<head>
  <title>Hello Handlebars</title>
  <style type="text/css">
    .redText {color:red;}
    .blueText {color:blue;}
    .greenText {color:green;}
  </style>

  <!-- You can download Handlebars at http:// handlebarsjs.com/ and save it as handlebars-v4.0.2.js on your site. Then make it available by adding the following line. -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>

  <!-- NodeJS is needed to precompile your templates so that your pages load faster. Install it by going to NodeJS.org and then type the following in your terminal to install Handlebars CLI : npm install -g handlebars-->

  <!--
  <script id="result-template" type="text/x-handlebars-template">

  </script> -->

</head>

<body>
<!-- The information will be placed in this div -->
  <div id="quoteData"></div>

  <script id="quoteTemplate" type="text/x-handlebars-template">
    <h3>Top {{name}} Quotes</h3>
    <ol>
        {{#each quotes}}
        <li>
            {{quote}}
        </li>
        {{/each}}
    </ol>
    {{{poppeaBio}}}
    <br />
    <br />
    {{makeLink "Poppea Recording" "https://youtu.be/9en2t2kR-M8"}}
    <br />
    <br />
    {{changeColor "Change text to red" color="green"}}
    <br />
    <br />
    {{sayHello}}
  </script>

  <script type="text/JavaScript">
    const quoteInfo = document.getElementById("quoteTemplate").innerHTML;
    const template = Handlebars.compile(quoteInfo);

    Handlebars.registerHelper("makeLink", (text, url) => {
        text = Handlebars.Utils.escapeExpression(text);
        url = Handlebars.Utils.escapeExpression(url);
        const linkElement = `<a href='${url}'>${text}</a>`;
        return new Handlebars.SafeString(linkElement);
    });

    Handlebars.registerHelper("changeColor", (text, {hash}) => {
        text = Handlebars.Utils.escapeExpression(text);
        return new Handlebars.SafeString(`<span class="${hash.color}Text">${text}</span>`);
    });

    Handlebars.registerHelper("sayHello", options => {
        console.log(options);
        switch (options.data.root.data.lang) {
            case "italian":
                return "Ciao";
                break;
            case "german":
                return "Hallo!";
                break;
            case "austrian":
                return "Grüß Gott";
                break;
            default:
                return "Hi!";
        }
    })

    const quoteData = template({
        name: "Poppea",
        quotes: [
            {quote: "Signor, deh non partir"},
            {quote: "Io son regina!"},
            {quote: "Per me guereggia amor e la fortuna"},
            {quote: "Pur ti miro"}
        ],
        poppeaBio: `<em>Poppea Sabina was the daughter of a prominant Roman Senator 
            who was the consort of Ottone (Otho) and later the wife of Emperor Nerone (Nero)
            and Empress of Rome</em>`,
        data: {
            lang: "italian"
        }

    });
    document.getElementById("quoteData").innerHTML += quoteData;
  </script>

</body>
</html>